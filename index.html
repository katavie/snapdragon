<!doctype html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Snapdragon</title>
    <link rel="stylesheet" href="skeleton.css">
    <link rel="stylesheet" href="styles.css">
    <script src="tracking.js"></script>
  </head>
  
  <body>
    <section id="snap">
      <button id="upload">Upload Photo</button>
      <button id="camera">Take Photo</button>
    </section>

    <section id="track">
      <div class="demo-container">
        <img id="img" src="psmove.png" />
      </div>
    </section>

    <section id="drag">
      
    </section>

    <script>
      window.onload = function() {
        var img = document.getElementById('img');
        var demoContainer = document.querySelector('.demo-container');

        var tracker = new tracking.ColorTracker(['magenta', 'cyan', 'yellow']);

        tracker.on('track', function(event) {
          event.data.forEach(function(rect) {
            window.plot(rect.x, rect.y, rect.width, rect.height, rect.color);
          });
        });

        tracking.track('#img', tracker);

        window.plot = function(x, y, w, h, color) {
          var rect = document.createElement('div');
          document.querySelector('.demo-container').appendChild(rect);
          rect.classList.add('rect');
          rect.style.border = '2px solid ' + color;
          rect.style.width = w + 'px';
          rect.style.height = h + 'px';
          rect.style.left = (img.offsetLeft + x) + 'px';
          console.log("img.offsetLeft: " + img.offsetLeft + x);
          console.log("img.offsetTop: " + img.offsetTop + h);
          rect.style.top = (img.offsetTop + y) + 'px';

          var duplicate = document.createElement('div');
          document.querySelector('#drag').appendChild(duplicate);
          duplicate.classList.add('duplicate');
          duplicate.style.backgroundPosition = "-" + img.offsetLeft + "px -" + img.offsetTop + "px";
          console.log("updated");
        };
      };
    </script>
</body>
</html>